import{h as S,o as y,f as _,b as t,F as P,r as q,t as u,e as B,g as E,U as F,V as L,q as R,A as k,k as J,a as n,u as V,i as A,x as O,d as f,O as D,X as z,Z as G,j,J as p}from"./app-43394236.js";import{_ as W}from"./Alert-051e22f4.js";import{B as X}from"./Breadcrumb-32527f39.js";import{_ as b}from"./Combobox-a4238030.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Z}from"./AuthenticatedLayout-3db205f7.js";import{r as H}from"./MagnifyingGlassIcon-60946dd0.js";import{r as K}from"./ArrowPathIcon-7c8ec28f.js";import{r as C}from"./ArrowTopRightOnSquareIcon-6017fd21.js";import{r as T}from"./PrinterIcon-bfbe258d.js";import{r as M}from"./PencilSquareIcon-26066ebb.js";import{r as N}from"./TrashIcon-0f8d4aa3.js";import"./_commonjsHelpers-de833af9.js";import"./XMarkIcon-bc558b0c.js";import"./use-outside-click-e0c0d3b1.js";import"./use-text-value-ed13f69d.js";import"./menu-d79329d0.js";import"./hidden-2febf338.js";import"./use-controllable-bc8024f1.js";import"./transition-a46c0b1d.js";import"./ChevronUpDownIcon-5cd8b824.js";import"./ShoppingBagIcon-d763d535.js";import"./XMarkIcon-ae32771d.js";import"./ChevronDownIcon-56a23db4.js";const h=r=>(F("data-v-93b50ab8"),r=r(),L(),r),Q={class:"bg-white rounded-xl shadow-2xl w-11/12 sm:w-10/12 md:w-96 max-h-[90vh] flex flex-col overflow-hidden relative"},tt={class:"sticky top-0 bg-white z-20 p-4 border-b border-gray-200 flex justify-between items-center"},et=h(()=>t("h2",{class:"text-xl font-bold text-gray-800"},"Order Details",-1)),st={class:"flex-1 overflow-y-auto p-4 custom-scrollbar"},at={class:"space-y-2 text-gray-700 text-sm"},rt=["title"],ot={class:"font-mono text-xs text-gray-500 text-right col-span-2"},lt={class:"font-mono text-right col-span-2"},dt={class:"sticky bottom-0 bg-white z-20 p-4 border-t border-gray-200"},nt={class:"grid grid-cols-2 gap-2 font-bold text-gray-800 mb-3"},it=h(()=>t("span",{class:"font-mono"},"Subtotal",-1)),ct={class:"font-mono text-right"},mt=h(()=>t("span",{class:"font-mono"},"VAT",-1)),pt={class:"font-mono text-right"},ut=h(()=>t("span",{class:"font-mono"},"Grand Total",-1)),xt={class:"font-mono text-right"},bt={class:"flex justify-end"},gt={__name:"OrderDetailsModal",props:{show:{type:Boolean,default:!1},products:{type:Array,default:()=>[]},vat:{type:Number,default:0}},setup(r){const w=r,s=S(()=>w.products.reduce((c,o)=>c+o.quantity*o.rate,0)),v=S(()=>s.value+w.vat),i=c=>Number(c).toLocaleString("en-US",{maximumFractionDigits:0});return(c,o)=>r.show?(y(),_("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:o[2]||(o[2]=B(l=>c.$emit("close"),["self"]))},[t("div",Q,[t("div",tt,[et,t("button",{onClick:o[0]||(o[0]=l=>c.$emit("close")),class:"text-gray-400 hover:text-gray-700 transition","aria-label":"Close Modal"},"✕")]),t("div",st,[t("ul",at,[(y(!0),_(P,null,q(r.products,(l,g)=>(y(),_("li",{key:g,class:"grid grid-cols-7 gap-2 px-2 py-1 border-b border-gray-200"},[t("span",{class:"font-mono col-span-3 truncate",title:l.name},u(g+1)+". "+u(l.name),9,rt),t("span",ot," ("+u(i(l.quantity))+" pc × "+u(i(l.rate))+") ",1),t("span",lt," ৳ "+u(i(l.quantity*l.rate)),1)]))),128))])]),t("div",dt,[t("div",nt,[it,t("span",ct,"৳ "+u(i(s.value)),1),mt,t("span",pt,"৳ "+u(i(r.vat)),1),ut,t("span",xt,"৳ "+u(i(v.value)),1)]),t("div",bt,[t("button",{onClick:o[1]||(o[1]=l=>c.$emit("close")),class:"px-4 py-2 rounded-lg bg-primary-600 text-white text-sm font-medium hover:bg-primary-700"},"Close")])])])])):E("",!0)}},yt=Y(gt,[["__scopeId","data-v-93b50ab8"]]),_t={class:"bg-white shadow"},ft={class:"px-4 sm:px-6 lg:max-w-6xl lg:mx-auto lg:px-8"},ht={class:"py-6 md:flex md:items-center md:justify-between lg:border-t lg:border-gray-200"},wt={class:"flex-1 min-w-0"},vt={class:"py-5"},$t={class:"max-w-full mx-auto sm:px-6 lg:px-8"},kt={class:"bg-white shadow sm:rounded-lg"},Vt={class:"flex flex-col sm:flex-row sm:justify-between items-center px-4 py-5 border-b border-gray-200 sm:px-8"},jt={class:"flex-1"},St=t("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Orders",-1),At={class:"mt-1 text-sm text-gray-500"},Ot=["onSubmit"],Dt={class:"p-5 mx-auto max-w-5xl"},Ct={class:"py-2 sm:grid sm:grid-cols-8 sm:gap-4"},Tt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Mt=t("label",{class:"block text-sm font-medium text-gray-700"},"Manager",-1),Nt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Pt=t("label",{class:"block text-sm font-medium text-gray-700"},"Waiter",-1),Bt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},It=t("label",{class:"block text-sm font-medium text-gray-700"},"Customer",-1),Ut={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},qt=t("label",{class:"block text-sm font-medium text-gray-700"},"Payment Method",-1),Et={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Ft=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1),Lt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Rt=t("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1),Jt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},zt=t("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1),Gt={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Wt=t("label",{class:"block text-sm font-medium text-gray-700"},"Action",-1),Xt={class:"flex w-full mt-1 rounded shadow-sm",role:"group"},Yt={type:"submit",class:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-l text-sm font-medium text-white bg-primary-600 hover:bg-primary-700"},Zt=["data-url"],Ht=t("thead",null,[t("tr",null,[t("th",{class:"w-5 px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},"#"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},[f("Date"),t("br"),f("dmY")]),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},"Waiter"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},"Number"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},"Description"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-right"},"Discount"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-right"},"Type"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-right"},"VAT"),t("th",{class:"px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-right"},"Total"),t("th",{class:"w-24 px-5 py-2 border-b bg-gray-100 text-xs font-bold uppercase tracking-wider text-center"},"Action")])],-1),Kt=t("tbody",{class:"bg-white"},null,-1),Qt=[Ht,Kt],ke=Object.assign({layout:Z},{__name:"Index",props:{filter:Object,managers:Array,waiters:Array,customers:Array,statuses:Array,payment_methods:Array},setup(r){const s=R(r.filter),v=[{name:"Orders",href:route("order.index"),current:!1},{name:"List Page",href:"#",current:!1}],i=k(!1),c=k([]),o=k("");window.showProductPopup=(m,e)=>{!m||!m.length||(c.value=m,o.value=e,i.value=!0)};const l=()=>Object.keys(s).forEach(m=>s[m]=""),g=()=>D.visit(route("order.index"),{data:s});function I(m){confirm("Are you sure you want to delete this order?")&&D.delete(route("order.destroy",m))}window.deleteRecord=I;const U=()=>{$("#ajax_table").DataTable({responsive:!0,serverSide:!0,processing:!0,destroy:!0,lengthMenu:[[10,25,50,100,200],[10,25,50,100,200]],dom:"<'flex flex-col sm:flex-row justify-between'lf><'block overflow-auto 'rt><'flex flex-col sm:flex-row justify-between items-center'ip>",ajax:{url:$("#ajax_table").data("url"),type:"GET",data:s},createdRow:(e,a)=>{$(e).toggleClass("text-gray-700",a.is_complete),$(e).toggleClass("text-red-700",!a.is_complete)},order:[[1,"desc"]],columns:[{data:null,class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-center",render:(e,a,x,d)=>d.row+d.settings._iDisplayStart+1},{data:"datetime_format",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-center"},{data:"waiter_name",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-center"},{data:"branch_invoice",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-center"},{data:"detail",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-center",sortable:!1,render:(e,a,x)=>`<span onclick='showProductPopup(${JSON.stringify(x.products||[])},${x.vat_amount})' class="cursor-pointer underline decoration-dotted">${e}</span>`},{data:"discount_amount_formated",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-right"},{data:"discount_type",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-right",render:e=>{if(!e)return"";const a={percent:"bg-green-100 text-green-800",flat:"bg-blue-100 text-blue-800"},x={percent:"Percent",flat:"Flat"};return`<span class="px-2 py-1 rounded-full text-xs font-semibold ${a[e]||"bg-gray-200 text-gray-800"}">${x[e]||e}</span>`}},{data:"vat_amount_formated",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-right"},{data:"total_formated",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5 text-right"},{data:"actions",class:"p-1 sm:py-2 whitespace-wrap border-b border-gray-200 text-sm leading-5",orderable:!1,searchable:!1,render:e=>`<div class="vue-actions" data-actions='${JSON.stringify(e).replace(/'/g,"&apos;")}'></div>`}]}).on("draw",()=>{document.querySelectorAll(".vue-actions").forEach(e=>{if(e.dataset.vueMounted)return;const a=JSON.parse(e.dataset.actions);z({props:["actions"],components:{Link:j,ArrowTopRightOnSquareIcon:C,PrinterIcon:T,PencilSquareIcon:M,TrashIcon:N},setup(d){return()=>p("div",{class:"flex justify-end space-x-2"},[d.actions.print_url&&p("a",{href:d.actions.print_url,target:"_blank",class:"text-green-600 hover:text-green-800"},[p(T,{class:"w-6 h-6"})]),d.actions.detail_url&&p(j,{href:d.actions.detail_url,class:"text-primary-600 hover:text-primary-800"},[p(C,{class:"w-6 h-6"})]),d.actions.edit_url&&p(j,{href:d.actions.edit_url,class:"text-indigo-600 hover:text-indigo-800"},{default:()=>p(M,{class:"w-6 h-6"})}),d.actions.delete_id&&p("button",{class:"text-red-600 hover:text-red-800",onClick:()=>window.deleteRecord(d.actions.delete_id)},[p(N,{class:"w-6 h-6"})])].filter(Boolean))}},{actions:a}).mount(e),e.dataset.vueMounted="true"})})};return J(()=>{U()}),(m,e)=>(y(),_(P,null,[n(V(G),{title:"Orders"}),t("div",_t,[t("div",ft,[t("div",ht,[t("div",wt,[n(X,{breadcrumbs:v})])])])]),t("div",vt,[t("div",$t,[t("div",kt,[t("div",Vt,[t("div",jt,[St,t("p",At,u((s.start_date?s.start_date.split("-").reverse().join("/"):"")+" - "+(s.end_date?s.end_date.split("-").reverse().join("/"):"")),1)])]),n(W),t("form",{onSubmit:B(g,["prevent"])},[t("dl",Dt,[t("div",Ct,[t("dd",Tt,[Mt,n(b,{class:"mt-1",modelValue:s.manager_id,"onUpdate:modelValue":e[0]||(e[0]=a=>s.manager_id=a),items:r.managers},null,8,["modelValue","items"])]),t("dd",Nt,[Pt,n(b,{class:"mt-1",modelValue:s.waiter_id,"onUpdate:modelValue":e[1]||(e[1]=a=>s.waiter_id=a),items:r.waiters},null,8,["modelValue","items"])]),t("dd",Bt,[It,n(b,{class:"mt-1",modelValue:s.customer_id,"onUpdate:modelValue":e[2]||(e[2]=a=>s.customer_id=a),items:r.customers},null,8,["modelValue","items"])]),t("dd",Ut,[qt,n(b,{class:"mt-1",modelValue:s.payment_method_id,"onUpdate:modelValue":e[3]||(e[3]=a=>s.payment_method_id=a),items:r.payment_methods},null,8,["modelValue","items"])]),t("dd",Et,[Ft,A(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.start_date=a),type:"date",class:"mt-1 block w-full px-4 border-gray-300 rounded sm:text-sm"},null,512),[[O,s.start_date]])]),t("dd",Lt,[Rt,A(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.end_date=a),type:"date",class:"mt-1 block w-full px-4 border-gray-300 rounded sm:text-sm"},null,512),[[O,s.end_date]])]),t("dd",Jt,[zt,n(b,{class:"mt-1",modelValue:s.status,"onUpdate:modelValue":e[6]||(e[6]=a=>s.status=a),items:r.statuses},null,8,["modelValue","items"])]),t("dd",Gt,[Wt,t("div",Xt,[t("button",Yt,[n(V(H),{class:"-ml-1 mr-2 h-5 w-5"}),f(" Search ")]),t("button",{onClick:l,class:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-primary-600 rounded-r text-sm font-medium text-primary-700 bg-white hover:bg-primary-50"},[n(V(K),{class:"-ml-1 mr-2 h-5 w-5"}),f(" Clear ")])])])])])],40,Ot),t("table",{class:"table-auto sm:table-fixed min-w-full w-full",id:"ajax_table","data-url":m.route("order.load")},Qt,8,Zt)])])]),n(yt,{show:i.value,products:c.value,vat:o.value,onClose:e[7]||(e[7]=a=>i.value=!1)},null,8,["show","products","vat"])],64))}});export{ke as default};
