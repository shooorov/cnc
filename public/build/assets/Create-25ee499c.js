import{T as j,A as b,E as C,o as g,f as _,a as l,w as v,u as r,b as t,t as p,d as m,e as R,i as d,x as u,F as w,r as T,y as S,Q as k,Z as A,j as N,p as B}from"./app-43394236.js";import{_ as D}from"./Alert-051e22f4.js";import{B as E}from"./Breadcrumb-32527f39.js";import{_ as F}from"./Combobox-a4238030.js";import{_ as x}from"./InputError-5426a390.js";import{_ as K}from"./Listbox-93365c37.js";import{_ as O}from"./AuthenticatedLayout-3db205f7.js";import{r as y}from"./PlusIcon-fcda2f3e.js";import{r as Q}from"./XMarkIcon-bc558b0c.js";import"./_commonjsHelpers-de833af9.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-outside-click-e0c0d3b1.js";import"./use-text-value-ed13f69d.js";import"./menu-d79329d0.js";import"./hidden-2febf338.js";import"./use-controllable-bc8024f1.js";import"./transition-a46c0b1d.js";import"./ChevronUpDownIcon-5cd8b824.js";import"./ShoppingBagIcon-d763d535.js";import"./XMarkIcon-ae32771d.js";import"./ChevronDownIcon-56a23db4.js";const L={class:"bg-white shadow"},M={class:"px-4 sm:px-6 lg:max-w-6xl lg:mx-auto lg:px-8"},P={class:"py-6 md:flex md:items-center md:justify-between lg:border-t lg:border-gray-200"},Z={class:"flex-1 min-w-0"},z={class:"mt-6 h-9 flex space-x-3 md:mt-0 md:ml-4"},G={class:"py-5"},H={class:"max-w-6xl mx-auto sm:px-6 lg:px-8"},I={class:"bg-white shadow sm:rounded-lg"},J={class:"flex flex-col sm:flex-row sm:justify-between items-center px-4 py-5 border-b border-gray-200 sm:px-8"},W={class:"max-w-2xl leading-10 text-gray-700 text-lg font-medium mb-4 sm:mb-0"},X={class:"flex-shrink-0 flex space-x-3"},Y=["onSubmit"],tt={class:"space-y-4 sm:space-y-6 px-5 py-6"},et={class:"max-w-xl mx-auto"},st={class:"grid grid-cols-6 gap-6"},ot={class:"col-span-6 sm:col-span-3"},at=t("label",{class:"block text-sm font-medium text-gray-700"},[m(" Requisition Date "),t("span",{class:"text-red-500"},"*")],-1),rt={class:"col-span-6 sm:col-span-3"},it=t("label",{class:"block text-sm font-medium text-gray-700"},[m(" Total Around "),t("span",{class:"text-red-500"},"*")],-1),lt={class:"col-span-6 sm:col-span-3"},nt=t("label",{class:"block text-sm font-medium text-gray-700"},[m(" Central Kitchen "),t("span",{class:"text-red-500"},"*")],-1),dt={class:"relative"},ct=t("div",{class:"absolute inset-0 flex items-center","aria-hidden":"true"},[t("div",{class:"w-full border-t border-gray-300"})],-1),ut={class:"relative flex justify-center ml-4"},mt={class:"px-3 bg-white text-lg font-medium text-gray-900"},pt={class:"max-w-5xl mx-auto space-y-4 sm:space-y-6"},ft={class:"w-1/3 flex mx-auto"},gt=t("span",{class:"sr-only"},"Dismiss",-1),_t={class:"max-w-5xl mx-auto space-y-4 sm:space-y-6"},xt={class:"table-auto sm:table-fixed min-w-full divide-y divide-gray-200"},yt={class:"bg-gray-50"},ht={scope:"col",class:"py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},bt=t("th",{scope:"col",class:"w-1/4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity",-1),vt=t("th",{scope:"col",class:"w-20 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"Unit",-1),wt=t("th",{scope:"col",class:"w-40 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Avg Rate",-1),kt=t("th",{scope:"col",class:"w-40 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total",-1),qt={class:"bg-white divide-y divide-gray-200"},Vt=["onUpdate:modelValue"],Ut=["onUpdate:modelValue","onKeyup"],$t=["onUpdate:modelValue"],jt=["onUpdate:modelValue"],Ct=["onUpdate:modelValue"],Rt={class:"bg-white"},Tt=t("th",{colspan:"4",scope:"col",class:"py-2 text-right text-lg font-medium font-mono"},"Total Around",-1),St={colspan:"1",scope:"col",class:"py-2 text-center text-lg font-medium font-mono"},At=S('<div class="relative"><div class="absolute inset-0 flex items-center" aria-hidden="true"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center ml-4"><span class="px-3 bg-white text-lg font-medium text-gray-900"></span></div></div>',1),Nt={class:"max-w-5xl mx-auto space-y-4 sm:space-y-6"},Bt={class:"flex justify-start"},Dt={type:"submit",class:"mr-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},ae=Object.assign({layout:O},{__name:"Create",props:{string_change:Object,items:Object,date:String,categories:Array,central_kitchens:Array},setup(c){const f=c,q=[{name:f.string_change.product+" Requisitions",href:route("product_requisition.index"),current:!1},{name:"Create Page",href:"#",current:!1}],e=j({central_kitchen_id:"",item_category_id:"",requisition_date:f.date,total:null,total_format:"",group_items:f.items.data.map(a=>(a.quantity="",a.total="",a.show=!0,a))}),V=b(null),U=b([]);function $(a){let o=e.group_items[a];o.total=Number(((o.avg_rate||0)*(o.quantity||0)).toFixed(3)),e.total=e.group_items.reduce((s,n)=>s+Number(n.total||0),0),e.total_format=e.total.toLocaleString("en-US")}async function h(){var o,s;let a=!0;if(e.errors={},!e.requisition_date){a=!1,e.setError("requisition_date","Requisition date is required."),await k(),(o=V.value)==null||o.focus();return}for(let n=0;n<e.group_items.length;n++){let i=e.group_items[n];if(i.quantity&&!i.rate){a=!1,e.setError(`group_items.${n}.rate`,"Rate is required when quantity is entered."),await k(),(s=U.value[n])==null||s.focus();return}}a&&e.post(route("product_requisition.store"))}return C(()=>e.item_category_id,a=>{e.group_items=f.items.data.map(o=>(o.rate="",o.quantity="",o.total="",o.show=!a||o.product_category_id==a,o))}),(a,o)=>(g(),_(w,null,[l(r(A),null,{default:v(()=>[t("title",null,"Create "+p(c.string_change.product)+" Requisition",1)]),_:1}),t("div",null,[t("div",L,[t("div",M,[t("div",P,[t("div",Z,[l(E,{breadcrumbs:q})]),t("div",z,[l(r(N),{href:a.route("product_requisition.create"),class:"inline-flex items-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white hover:bg-gray-50 text-sm font-medium text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-primary-400"},{default:v(()=>[l(r(y),{class:"-ml-1 mr-2 h-5 w-5 text-gray-400","aria-hidden":"true"}),m(" Create ")]),_:1},8,["href"])])])])]),t("div",G,[t("div",H,[t("div",I,[t("div",J,[t("p",W,p(c.string_change.product)+" Requisition Create",1),t("div",X,[t("button",{onClick:h,class:"mr-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},[l(r(y),{class:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),m(" Create ")])])]),l(D),t("form",{onSubmit:R(h,["prevent"])},[t("dl",tt,[t("div",et,[t("div",st,[t("div",ot,[at,d(t("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>r(e).requisition_date=s),type:"date",class:"mt-1 block w-full px-4 focus:ring-primary-400 focus:border-primary-400 hover:bg-gray-100 focus:bg-transparent sm:text-sm border-gray-300 rounded"},null,512),[[u,r(e).requisition_date]]),l(x,{message:a.$page.props.errors.requisition_date},null,8,["message"])]),t("div",rt,[it,d(t("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>r(e).total=s),type:"text",placeholder:"Total",readonly:"",class:"mt-1 block w-full px-4 focus:ring-none focus:ring-0 focus:ring-primary-400 focus:border-primary-400 bg-gray-100 sm:text-sm border-gray-300 rounded"},null,512),[[u,r(e).total]]),l(x,{message:a.$page.props.errors.total},null,8,["message"])]),t("div",lt,[nt,l(F,{class:"mt-1",modelValue:r(e).central_kitchen_id,"onUpdate:modelValue":o[2]||(o[2]=s=>r(e).central_kitchen_id=s),items:c.central_kitchens},null,8,["modelValue","items"]),l(x,{message:a.$page.props.errors.central_kitchen_id},null,8,["message"])])])]),t("div",dt,[ct,t("div",ut,[t("span",mt,p(c.string_change.product_s),1)])]),t("div",pt,[t("div",ft,[l(K,{class:"",modelValue:r(e).item_category_id,"onUpdate:modelValue":o[3]||(o[3]=s=>r(e).item_category_id=s),items:c.categories},null,8,["modelValue","items"]),t("button",{onClick:o[4]||(o[4]=s=>r(e).item_category_id=null),type:"button",class:"my-0.5 ml-1 inline-flex rounded p-1.5 text-gray-500 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-1"},[gt,l(r(Q),{class:"h-5 w-5","aria-hidden":"true"})])])]),t("div",_t,[t("table",xt,[t("thead",yt,[t("tr",null,[t("th",ht,p(c.string_change.product),1),bt,vt,wt,kt])]),t("tbody",qt,[(g(!0),_(w,null,T(r(e).group_items,(s,n)=>d((g(),_("tr",{key:n},[t("td",null,[d(t("input",{"onUpdate:modelValue":i=>s.name=i,readonly:"",type:"text",autocomplete:"off",class:"block w-full px-4 bg-gray-100 sm:text-sm border-gray-300 rounded"},null,8,Vt),[[u,s.name]])]),t("td",null,[d(t("input",{"onUpdate:modelValue":i=>s.quantity=i,onKeyup:i=>$(n),placeholder:"Quantity",type:"text",oninput:"this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\\..*?)\\..*/g, '$1');",class:"block w-full px-4 pr-24 focus:ring-primary-400 focus:border-primary-400 hover:bg-gray-100 focus:bg-transparent sm:text-sm border-gray-300 rounded"},null,40,Ut),[[u,s.quantity,void 0,{number:!0}]])]),t("td",null,[d(t("input",{"onUpdate:modelValue":i=>s.unit=i,readonly:"",type:"text",autocomplete:"off",class:"block w-full px-4 bg-gray-100 sm:text-sm border-gray-300 rounded"},null,8,$t),[[u,s.unit]])]),t("td",null,[d(t("input",{"onUpdate:modelValue":i=>s.avg_rate=i,placeholder:"Avg Rate",readonly:"",type:"text",autocomplete:"off",class:"block w-full px-4 bg-gray-100 sm:text-sm border-gray-300 rounded"},null,8,jt),[[u,s.avg_rate]])]),t("td",null,[d(t("input",{"onUpdate:modelValue":i=>s.total=i,placeholder:"Total",readonly:"",type:"text",autocomplete:"off",class:"block w-full px-4 bg-gray-100 sm:text-sm border-gray-300 rounded"},null,8,Ct),[[u,s.total]])])])),[[B,s.show]])),128))]),t("tfoot",Rt,[t("tr",null,[Tt,t("th",St,p(r(e).total_format),1)])])])]),At,t("div",Nt,[t("div",Bt,[t("button",Dt,[l(r(y),{class:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),m(" Create ")])])])])],40,Y)])])])])],64))}});export{ae as default};
